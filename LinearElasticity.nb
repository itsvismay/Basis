(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     48599,       1288]
NotebookOptionsPosition[     46017,       1200]
NotebookOutlinePosition[     46351,       1215]
CellTagsIndexPosition[     46308,       1212]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getpt", "[", 
    RowBox[{"pts_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"pts", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"2", "*", "i"}], "-", "1"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"pts", "\[LeftDoubleBracket]", 
      RowBox[{"2", "*", "i"}], "\[RightDoubleBracket]"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7216963758268127`*^9, 3.721696385724882*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"restpts", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "x1", ",", " ", "y1", ",", "x2", ",", " ", "y2", ",", " ", "x3", ",", " ",
      "y3", ",", " ", "x4", ",", "y4"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.685498656362649*^9, {3.721696414234461*^9, 3.721696428811139*^9}, {
   3.721696741187922*^9, 3.721696744302752*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getTri", "[", 
    RowBox[{"pts_", ",", "verts_"}], "]"}], ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"pts", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"2", "*", 
         RowBox[{"verts", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "-", "1"}], "]"}], "]"}], ",", 
     " ", 
     RowBox[{"pts", "[", 
      RowBox[{"[", 
       RowBox[{"2", "*", 
        RowBox[{"verts", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"pts", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"2", "*", 
         RowBox[{"verts", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "-", "1"}], "]"}], "]"}], ",", 
     "  ", 
     RowBox[{"pts", "[", 
      RowBox[{"[", 
       RowBox[{"2", "*", 
        RowBox[{"verts", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"pts", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"2", "*", 
         RowBox[{"verts", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "-", "1"}], "]"}], "]"}], ",", 
     "  ", 
     RowBox[{"pts", "[", 
      RowBox[{"[", 
       RowBox[{"2", "*", 
        RowBox[{"verts", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.721696394597691*^9, 3.721696394695726*^9}, {
  3.721696458474905*^9, 3.721696486961522*^9}, {3.721696535353112*^9, 
  3.721696550888783*^9}, {3.7216966587879353`*^9, 3.721696707944297*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"getTri", "[", 
   RowBox[{"restpts", ",", " ", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], "[", 
  RowBox[{"[", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Append", "[", 
  RowBox[{
   RowBox[{"getTri", "[", 
    RowBox[{"restpts", ",", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "4"}], "}"}]}], "]"}], ",", "0"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6855135512684317`*^9, 3.6855135785791597`*^9}, {
  3.68551388228275*^9, 3.685513898936976*^9}, {3.72169661322404*^9, 
  3.721696629998128*^9}, {3.721696716237755*^9, 3.721696732963175*^9}, {
  3.721747373250457*^9, 3.7217474041733503`*^9}, {3.721747678166832*^9, 
  3.7217476783785677`*^9}, {3.721747709999008*^9, 3.7217477114013*^9}, {
  3.7217477894982224`*^9, 3.7217477923195057`*^9}, {3.7217479699863157`*^9, 
  3.7217480829924517`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x1", ",", "y1"}], "}"}]], "Output",
 CellChangeTimes->{3.721748083570902*^9, 3.7217481748224583`*^9, 
  3.721748327293515*^9, 3.721748405620784*^9, 3.721748763564435*^9, 
  3.721749576983336*^9, 3.7217498568450603`*^9, 3.7219446934992847`*^9, 
  3.722355467614357*^9, 3.722356029026517*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "x1", ",", "y1", ",", "x3", ",", "y3", ",", "x4", ",", "y4", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.721748083570902*^9, 3.7217481748224583`*^9, 
  3.721748327293515*^9, 3.721748405620784*^9, 3.721748763564435*^9, 
  3.721749576983336*^9, 3.7217498568450603`*^9, 3.7219446934992847`*^9, 
  3.722355467614357*^9, 3.722356029030274*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"initpts", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{
    "0", ",", "0", ",", "    ", "4", ",", "0", ",", "    ", "4", ",", "4", 
     ",", "    ", "0", ",", "4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vels", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{
    "1", ",", "0", ",", "    ", "0", ",", "0", ",", "    ", "0", ",", "0", 
     ",", "    ", "0", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.685559337972929*^9, 3.6855593467102633`*^9}, {
   3.685559409941435*^9, 3.685559417233224*^9}, {3.685560874674183*^9, 
   3.685560875203999*^9}, {3.685561152359284*^9, 3.685561171981941*^9}, {
   3.685562760069458*^9, 3.685562772001524*^9}, {3.685588898615511*^9, 
   3.685588904723489*^9}, {3.685590470695446*^9, 3.6855904708286257`*^9}, {
   3.691297471977092*^9, 3.691297474732924*^9}, {3.692062440226218*^9, 
   3.692062455889305*^9}, {3.692062683594913*^9, 3.692062683718691*^9}, 
   3.699151928805385*^9, {3.721696800079647*^9, 3.721696856720551*^9}, {
   3.721748152661121*^9, 3.721748159486205*^9}, {3.7217483186549997`*^9, 
   3.721748325282916*^9}, {3.7217487547776318`*^9, 3.7217487614805717`*^9}, {
   3.721749513262948*^9, 3.721749513351267*^9}, {3.722355455763341*^9, 
   3.722355462678916*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"timestep", " ", "=", " ", "0.001"}], ";"}]], "Input",
 CellChangeTimes->{3.722355401018361*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"youngs", " ", "=", " ", 
   RowBox[{"1", "*", 
    RowBox[{"10", "^", "6"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"poisson", " ", "=", " ", "0.45"}], ";"}]}], "Input",
 CellChangeTimes->{{3.685498694372764*^9, 3.6854987062239513`*^9}, {
  3.6855098171631117`*^9, 3.6855098180197363`*^9}, {3.69129759680589*^9, 
  3.6912975972631893`*^9}, {3.7216968611306067`*^9, 3.721696866642181*^9}, {
  3.721701840662478*^9, 3.7217018447049923`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mu", " ", "=", " ", 
   RowBox[{"youngs", "/", 
    RowBox[{"(", 
     RowBox[{"2", "+", 
      RowBox[{"2", "*", "poisson"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lambda", " ", "=", " ", 
   RowBox[{"youngs", "*", 
    RowBox[{"poisson", "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "poisson"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", "*", "poisson"}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tri1", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tri2", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3", ",", "4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rayleigh", " ", "=", " ", "0.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gravity", " ", "=", " ", 
   RowBox[{"-", "0"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.685509830813161*^9, 3.685509831042*^9}, {
   3.6855143478066263`*^9, 3.685514353496991*^9}, {3.6855859489005423`*^9, 
   3.685585949438818*^9}, 3.685590438701808*^9, 3.6912974957372*^9, {
   3.721696874146428*^9, 3.721696893645967*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TriRefShapeMatrix", "[", "pts_", "]"}], " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "1"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "-", 
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "3"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "2"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "-", 
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "3"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "1"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], " ", "-", 
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "3"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "2"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], " ", "-", 
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "3"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "}"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.721700616253606*^9, 3.721700655502717*^9}, {
  3.721700699692565*^9, 3.721700766894882*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.685513180524516*^9, 3.6855132048969917`*^9}, {
  3.6855132458918962`*^9, 3.6855132886708937`*^9}, {3.685513462680694*^9, 
  3.6855134640296793`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"F1", "[", "pts_", "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"TriRefShapeMatrix", "[", 
      RowBox[{"getTri", "[", 
       RowBox[{"pts", ",", " ", "tri1"}], "]"}], "]"}], ".", 
     RowBox[{"Inverse", "[", 
      RowBox[{"TriRefShapeMatrix", "[", 
       RowBox[{"getTri", "[", 
        RowBox[{"initpts", ",", "tri1"}], "]"}], "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{
  3.685498736428647*^9, {3.685514387015091*^9, 3.685514391759424*^9}, {
   3.692493456830328*^9, 3.69249345727635*^9}, {3.7217007872838507`*^9, 
   3.721700829473448*^9}, {3.721748551083342*^9, 3.7217485561725187`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"F1", "[", "initpts", "]"}]], "Input",
 CellChangeTimes->{{3.7217485594992313`*^9, 3.721748563023251*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.721748563855719*^9, 3.7217485713806047`*^9}, 
   3.7217487636517563`*^9, 3.721749577576742*^9, 3.721749856942027*^9, 
   3.721944693590176*^9, 3.722355468226986*^9, 3.72235602963168*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"F2", "[", "pts_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"TriRefShapeMatrix", "[", 
     RowBox[{"getTri", "[", 
      RowBox[{"pts", ",", " ", "tri2"}], "]"}], "]"}], ".", 
    RowBox[{"Inverse", "[", 
     RowBox[{"TriRefShapeMatrix", "[", 
      RowBox[{"getTri", "[", 
       RowBox[{"initpts", ",", " ", "tri2"}], "]"}], "]"}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.685498747569211*^9, {3.7217007908546133`*^9, 3.721700791346547*^9}, {
   3.72170119260972*^9, 3.721701202252936*^9}, {3.7217016980756617`*^9, 
   3.7217017032095537`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Epsilon", "[", "F_", "]"}], " ", ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "/", "2.0"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"F", " ", "+", 
       RowBox[{"Transpose", "[", "F", "]"}]}], ")"}]}], " ", "-", " ", 
    RowBox[{"IdentityMatrix", "[", "2", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.721695756302845*^9, 3.721695865836762*^9}, {
  3.72169589698394*^9, 3.721695907708777*^9}, {3.721701224490643*^9, 
  3.7217012245876293`*^9}, {3.7217473175858393`*^9, 3.7217473178633127`*^9}}],

Cell["Linear Elasticity", "Item",
 CellChangeTimes->{{3.721695369236164*^9, 3.7216954484502153`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"EnergyDensity", "[", "F_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"mu", "*", 
     RowBox[{"Tr", "[", 
      RowBox[{
       RowBox[{"Epsilon", "[", "F", "]"}], ".", 
       RowBox[{"Epsilon", "[", "F", "]"}]}], "]"}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"lambda", "/", "2"}], ")"}], "*", 
     RowBox[{"Tr", "[", 
      RowBox[{"Epsilon", "[", "F", "]"}], "]"}], "*", 
     RowBox[{"Tr", "[", 
      RowBox[{"Epsilon", "[", "F", "]"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Tri1Area", " ", "=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1.0", "/", "2.0"}], ")"}], "*", 
   RowBox[{"Norm", "[", "\[IndentingNewLine]", " ", 
    RowBox[{"Cross", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"getTri", "[", 
           RowBox[{"initpts", ",", " ", "tri1"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}], " ", "-", " ", 
         RowBox[{
          RowBox[{"getTri", "[", 
           RowBox[{"initpts", ",", " ", "tri1"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"{", 
            RowBox[{"5", ",", "6"}], "}"}], "]"}], "]"}]}], ",", "0"}], "]"}],
       ",", "\[IndentingNewLine]", "\t", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"getTri", "[", " ", 
           RowBox[{"initpts", ",", " ", "tri1"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"{", 
            RowBox[{"3", ",", "4"}], "}"}], "]"}], "]"}], " ", "-", " ", 
         RowBox[{
          RowBox[{"getTri", "[", 
           RowBox[{"initpts", ",", " ", "tri1"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"{", 
            RowBox[{"5", ",", "6"}], "}"}], "]"}], "]"}]}], ",", "0"}], 
       "]"}]}], "\[IndentingNewLine]", "\t", "]"}], "\[IndentingNewLine]", 
    "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.6855119658373404`*^9, 3.6855119661894217`*^9}, {
   3.6920622695101547`*^9, 3.692062391957178*^9}, {3.692062583312969*^9, 
   3.692062593031521*^9}, 3.721695738010503*^9, {3.721695923710083*^9, 
   3.721695980607151*^9}, 3.721701301335597*^9, {3.7217013438678827`*^9, 
   3.7217013445211763`*^9}, {3.721701745836254*^9, 3.721701757521563*^9}, {
   3.7217473135088453`*^9, 3.7217473583704576`*^9}, {3.7217474466076393`*^9, 
   3.721747528191677*^9}, {3.721747562633189*^9, 3.721747629305867*^9}, 
   3.721747663634314*^9, {3.721747846072962*^9, 3.721747861386156*^9}, {
   3.721748092298895*^9, 3.721748111342822*^9}}],

Cell[BoxData["8.`"], "Output",
 CellChangeTimes->{3.7217481121394577`*^9, 3.721748174919609*^9, 
  3.721748327389255*^9, 3.7217484057171803`*^9, 3.7217487636926117`*^9, 
  3.7217495779222717`*^9, 3.721749856979006*^9, 3.721944693649171*^9, 
  3.7223554686183233`*^9, 3.722356030008463*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tri2Area", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1.0", "/", "2.0"}], ")"}], "*", 
      RowBox[{"Norm", "[", "\[IndentingNewLine]", " ", 
       RowBox[{"Cross", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"getTri", "[", 
              RowBox[{"initpts", ",", " ", "tri2"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}], " ", "-", " ", 
            RowBox[{
             RowBox[{"getTri", "[", 
              RowBox[{"initpts", ",", " ", "tri2"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{"5", ",", "6"}], "}"}], "]"}], "]"}]}], ",", "0"}], 
          "]"}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"getTri", "[", " ", 
              RowBox[{"initpts", ",", " ", "tri2"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{"3", ",", "4"}], "}"}], "]"}], "]"}], " ", "-", " ", 
            RowBox[{
             RowBox[{"getTri", "[", 
              RowBox[{"initpts", ",", " ", "tri2"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{"5", ",", "6"}], "}"}], "]"}], "]"}]}], ",", "0"}], 
          "]"}]}], "\[IndentingNewLine]", "\t", "]"}], "\[IndentingNewLine]", 
       "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"gravE", "[", "pts_", "]"}], ":=", 
     RowBox[{"gravity", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{"getTri", "[", 
            RowBox[{"pts", ",", " ", "tri1"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"{", 
             RowBox[{"2", ",", " ", "4", ",", " ", "6"}], "}"}], "]"}], "]"}],
           "]"}], "*", 
         RowBox[{"Tri1Area", "/", "4"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{"getTri", "[", 
            RowBox[{"pts", ",", " ", "tri2"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"{", 
             RowBox[{"2", ",", " ", "4", ",", " ", "5"}], "}"}], "]"}], "]"}],
           "]"}], "*", 
         RowBox[{"Tri2Area", "/", "4"}]}]}], ")"}], "*", "1.05", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "3"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"totalE", "[", "pts_", "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"Tri1Area", "*", 
      RowBox[{"EnergyDensity", "[", 
       RowBox[{"F1", "[", "pts", "]"}], "]"}]}], " ", "+", 
     RowBox[{"Tri2Area", "*", 
      RowBox[{"EnergyDensity", "[", 
       RowBox[{"F2", "[", "pts", "]"}], "]"}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.685511753021058*^9, 3.685511755955881*^9}, {
   3.6855119140842543`*^9, 3.6855119172816877`*^9}, {3.6855119747452583`*^9, 
   3.685511976291321*^9}, {3.685512010641775*^9, 3.685512053954968*^9}, {
   3.685513161792041*^9, 3.685513162555416*^9}, 3.685513474159597*^9, {
   3.6855143585544443`*^9, 3.685514372523017*^9}, {3.68551454564814*^9, 
   3.685514550034395*^9}, {3.6855594540992403`*^9, 3.6855594753816547`*^9}, {
   3.692492031731407*^9, 3.6924920491303596`*^9}, {3.692492084554826*^9, 
   3.69249209287045*^9}, {3.721701235353207*^9, 3.721701261678927*^9}, 
   3.721701298997425*^9, {3.721701348960711*^9, 3.721701401609962*^9}, {
   3.7217014775089273`*^9, 3.7217014828916073`*^9}, {3.7217015143539133`*^9, 
   3.721701548296303*^9}, 3.721701618237072*^9, {3.721701857368042*^9, 
   3.721701864252863*^9}, {3.721747320503067*^9, 3.721747320666007*^9}, {
   3.721747423697394*^9, 3.721747438025279*^9}, {3.7217481277196903`*^9, 
   3.721748143611648*^9}, {3.721748376345914*^9, 3.72174838456118*^9}, {
   3.721748503816271*^9, 3.721748512418126*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"totalE", "[", "restpts", "]"}]], "Input",
 CellChangeTimes->{{3.685559481732925*^9, 3.685559488817741*^9}, {
  3.721748521739655*^9, 3.721748522338912*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"8.`", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"1.551724137931035`*^6", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", 
         RowBox[{"0.5`", " ", 
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             RowBox[{"x2", "-", "x3"}], "2"], "+", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x1"}], "+", "x3"}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"0.25`", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "y2"}], "+", "y3"}], ")"}]}]}], ")"}], "2"]}], "+", 
     RowBox[{"344827.5862068966`", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"0.5`", " ", 
            RowBox[{"(", 
             RowBox[{
              FractionBox[
               RowBox[{"x2", "-", "x3"}], "2"], "+", 
              RowBox[{
               FractionBox["1", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "x1"}], "+", "x3"}], ")"}]}]}], ")"}]}]}], 
          ")"}], "2"], "+", 
        RowBox[{"0.5`", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox["1", "4"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x2"}], "+", "x3"}], ")"}]}], "+", 
            FractionBox[
             RowBox[{"y2", "-", "y3"}], "4"], "+", 
            RowBox[{
             FractionBox["1", "4"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "y1"}], "+", "y3"}], ")"}]}]}], ")"}], "2"]}], 
        "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"0.25`", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "y2"}], "+", "y3"}], ")"}]}]}], ")"}], "2"]}], 
       ")"}]}]}], ")"}]}], "+", 
  RowBox[{"8.`", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"1.551724137931035`*^6", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", 
         RowBox[{"0.25`", " ", 
          RowBox[{"(", 
           RowBox[{"x3", "-", "x4"}], ")"}]}], "+", 
         RowBox[{"0.25`", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "y1"}], "+", "y4"}], ")"}]}]}], ")"}], "2"]}], "+", 
     RowBox[{"344827.5862068966`", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"0.25`", " ", 
            RowBox[{"(", 
             RowBox[{"x3", "-", "x4"}], ")"}]}]}], ")"}], "2"], "+", 
        RowBox[{"0.5`", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox["1", "4"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x1"}], "+", "x4"}], ")"}]}], "+", 
            FractionBox[
             RowBox[{"y3", "-", "y4"}], "4"]}], ")"}], "2"]}], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"0.25`", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "y1"}], "+", "y4"}], ")"}]}]}], ")"}], "2"]}], 
       ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.685559490703395*^9, 3.685560756279195*^9, 3.685560882750745*^9, {
   3.685562738736247*^9, 3.68556274709476*^9}, {3.685585935937595*^9, 
   3.685585960395442*^9}, 3.685588872353931*^9, 3.685588906808453*^9, 
   3.6855907768776703`*^9, 3.68559707413872*^9, 3.690627523522194*^9, 
   3.691297283548461*^9, 3.691297383281707*^9, 3.6912974988553467`*^9, 
   3.691297600307734*^9, 3.69206239882024*^9, {3.692062481873893*^9, 
   3.6920624852713127`*^9}, 3.692062595070709*^9, {3.692062674986771*^9, 
   3.692062685784183*^9}, 3.69249211787683*^9, 3.699149711057393*^9, 
   3.721695995413104*^9, 3.7217012787479763`*^9, 3.721701707197441*^9, 
   3.7217017607486763`*^9, 3.721701815891961*^9, {3.72170184743156*^9, 
   3.721701866845533*^9}, 3.721748174948951*^9, 3.7217483274350986`*^9, {
   3.72174838782241*^9, 3.721748405770859*^9}, {3.721748519449115*^9, 
   3.7217485228290453`*^9}, 3.721748763725276*^9, 3.72174957810569*^9, 
   3.7217498570075006`*^9, 3.721944693671908*^9, 3.7223554688144703`*^9, 
   3.722356030222137*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dEnergy", "[", "pts_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"totalE", "[", "restpts", "]"}], ",", " ", 
       RowBox[{"{", "restpts", "}"}]}], "]"}]}], "/.", 
    RowBox[{"Thread", "[", 
     RowBox[{"restpts", "\[Rule]", " ", "pts"}], "]"}]}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dEnergy", "[", "initpts", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.685561638015293*^9, 3.685561659818923*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6855616442181587`*^9, 3.685561660350711*^9}, 
   3.685562747129466*^9, {3.6855859359802113`*^9, 3.685585960437284*^9}, 
   3.685588872398314*^9, 3.685588906849429*^9, 3.685590776917897*^9, 
   3.685597074185408*^9, 3.690627523569762*^9, 3.69129728375805*^9, 
   3.691297383445352*^9, 3.691297499085423*^9, 3.691297600546175*^9, 
   3.692062398971591*^9, {3.692062481917242*^9, 3.6920624853167543`*^9}, 
   3.692062595116994*^9, {3.692062675032363*^9, 3.6920626858282223`*^9}, 
   3.6924921179502773`*^9, 3.699149711119379*^9, 3.721695995439692*^9, 
   3.721701278877863*^9, 3.721701707228529*^9, 3.7217017607842216`*^9, {
   3.7217018198409653`*^9, 3.721701866882759*^9}, 3.7217481749805*^9, 
   3.721748327464567*^9, {3.721748392003039*^9, 3.721748405800098*^9}, 
   3.7217487637580223`*^9, 3.7217495782870207`*^9, 3.721749857035244*^9, 
   3.7219446936953*^9, 3.722355469012532*^9, 3.722356030416202*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dForces", "[", "pts_", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"dEnergy", "[", "restpts", "]"}], ",", " ", 
      RowBox[{"{", "restpts", "}"}]}], "]"}], " ", "/.", " ", 
    RowBox[{"Thread", "[", 
     RowBox[{"restpts", " ", "\[Rule]", " ", "pts"}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.685560758715434*^9, 3.6855607596477613`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dForces", "[", "initpts", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{
  3.685509826813908*^9, {3.685514398098064*^9, 3.685514427160945*^9}, {
   3.685514529136002*^9, 3.685514604421852*^9}, 3.685559438057251*^9, {
   3.685589052873085*^9, 3.685589057403537*^9}, 3.685598502858028*^9, {
   3.7217018273194113`*^9, 3.721701831957711*^9}, {3.721702059846683*^9, 
   3.7217020631854067`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "2.06896551724138`*^6"}], "0", "1.8965517241379316`*^6", 
      RowBox[{"-", "1.551724137931035`*^6"}], "0.`", "1.7241379310344832`*^6",
       "172413.7931034483`", 
      RowBox[{"-", "172413.7931034483`"}]},
     {"0", 
      RowBox[{"-", "2.06896551724138`*^6"}], 
      RowBox[{"-", "172413.7931034483`"}], "172413.7931034483`", 
      "1.7241379310344832`*^6", "0.`", 
      RowBox[{"-", "1.551724137931035`*^6"}], "1.8965517241379316`*^6"},
     {"1.8965517241379316`*^6", 
      RowBox[{"-", "172413.7931034483`"}], 
      RowBox[{"-", "2.0689655172413797`*^6"}], "1.7241379310344832`*^6", 
      "172413.7931034483`", 
      RowBox[{"-", "1.551724137931035`*^6"}], "0", "0"},
     {
      RowBox[{"-", "1.551724137931035`*^6"}], "172413.7931034483`", 
      "1.7241379310344832`*^6", 
      RowBox[{"-", "2.0689655172413797`*^6"}], 
      RowBox[{"-", "172413.7931034483`"}], "1.8965517241379316`*^6", "0", "0"},
     {"0", "1.7241379310344832`*^6", "172413.7931034483`", 
      RowBox[{"-", "172413.7931034483`"}], 
      RowBox[{"-", "2.06896551724138`*^6"}], "0.`", "1.8965517241379316`*^6", 
      
      RowBox[{"-", "1.551724137931035`*^6"}]},
     {"1.7241379310344832`*^6", "0", 
      RowBox[{"-", "1.551724137931035`*^6"}], "1.8965517241379316`*^6", "0.`", 
      RowBox[{"-", "2.06896551724138`*^6"}], 
      RowBox[{"-", "172413.7931034483`"}], "172413.7931034483`"},
     {"172413.7931034483`", 
      RowBox[{"-", "1.551724137931035`*^6"}], "0", "0", 
      "1.8965517241379316`*^6", 
      RowBox[{"-", "172413.7931034483`"}], 
      RowBox[{"-", "2.0689655172413797`*^6"}], "1.7241379310344832`*^6"},
     {
      RowBox[{"-", "172413.7931034483`"}], "1.8965517241379316`*^6", "0", "0", 
      RowBox[{"-", "1.551724137931035`*^6"}], "172413.7931034483`", 
      "1.7241379310344832`*^6", 
      RowBox[{"-", "2.0689655172413797`*^6"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.721701832670189*^9, 3.721701866923214*^9}, 
   3.721702063813447*^9, 3.721748175015016*^9, 3.721748327499449*^9, {
   3.7217483968014507`*^9, 3.721748405834722*^9}, 3.721748763795669*^9, 
   3.721749578531822*^9, 3.7217498570686407`*^9, 3.721944693725444*^9, {
   3.7223554692852497`*^9, 3.722355488078224*^9}, 3.722356030567567*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mymasses", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0.16", ",", "0.00", ",", "0.04", ",", "0.00", ",", "0.08", ",", "0.00",
        ",", "0.04", ",", "0.00"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.00", ",", "0.16", ",", "0.00", ",", "0.04", ",", "0.00", ",", "0.08",
        ",", "0.00", ",", "0.04"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.04", ",", "0.00", ",", "0.08", ",", "0.00", ",", "0.04", ",", "0.00",
        ",", "0.00", ",", "0.00"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.00", ",", "0.04", ",", "0.00", ",", "0.08", ",", "0.00", ",", "0.04",
        ",", "0.00", ",", "0.00"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.08", ",", "0.00", ",", "0.04", ",", "0.00", ",", "0.16", ",", "0.00",
        ",", "0.04", ",", "0.00"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.00", ",", "0.08", ",", "0.00", ",", "0.04", ",", "0.00", ",", "0.16",
        ",", "0.00", ",", "0.04"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.04", ",", "0.00", ",", "0.00", ",", "0.00", ",", "0.04", ",", "0.00",
        ",", "0.08", ",", "0.00"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.00", ",", "0.04", ",", "0.00", ",", "0.00", ",", "0.00", ",", "0.04",
        ",", "0.00", ",", "0.08"}], "}"}]}], "}"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.691297346829157*^9, 3.691297377501408*^9}, {
   3.691297414538756*^9, 3.691297437408287*^9}, 3.721702941625718*^9, {
   3.72170317998241*^9, 3.721703182730523*^9}, {3.721703628899715*^9, 
   3.7217036313589573`*^9}, {3.721749421622428*^9, 3.721749439193405*^9}, 
   3.72174973276814*^9, 3.721749809391986*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.16`", ",", "0.`", ",", "0.04`", ",", "0.`", ",", "0.08`", ",", "0.`", 
     ",", "0.04`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.16`", ",", "0.`", ",", "0.04`", ",", "0.`", ",", "0.08`", 
     ",", "0.`", ",", "0.04`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.04`", ",", "0.`", ",", "0.08`", ",", "0.`", ",", "0.04`", ",", "0.`", 
     ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.04`", ",", "0.`", ",", "0.08`", ",", "0.`", ",", "0.04`", 
     ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.08`", ",", "0.`", ",", "0.04`", ",", "0.`", ",", "0.16`", ",", "0.`", 
     ",", "0.04`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.08`", ",", "0.`", ",", "0.04`", ",", "0.`", ",", "0.16`", 
     ",", "0.`", ",", "0.04`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.04`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.04`", ",", "0.`", 
     ",", "0.08`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.04`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.04`", 
     ",", "0.`", ",", "0.08`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.721749809782415*^9, 3.721749857090308*^9, 
  3.7219446937444763`*^9, 3.722355469524591*^9, 3.7223560307010517`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"gaussmasses", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "10.4167", ",", "0", ",", "2.60417", ",", "0", ",", "5.20833", ",", "0",
        ",", "2.60417", ",", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "10.4167", ",", "0", ",", "2.60417", ",", "0", ",", "5.20833",
        ",", "0", ",", "2.60417"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "2.60417", ",", "0", ",", "5.20833", ",", "0", ",", "2.60417", ",", "0",
        ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "2.60417", ",", "0", ",", "5.20833", ",", "0", ",", "2.60417",
        ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "5.20833", ",", "0", ",", "2.60417", ",", "0", ",", "10.4167", ",", "0",
        ",", "2.60417", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "5.20833", ",", "0", ",", "2.60417", ",", "0", ",", "10.4167",
        ",", "0", ",", "2.60417"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "2.60417", ",", "0", ",", "0", ",", "0", ",", "2.60417", ",", "0", ",", 
       "5.20833", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "2.60417", ",", "0", ",", "0", ",", "0", ",", "2.60417", ",", 
       "0", ",", "5.20833"}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.721703228812603*^9, 3.721703231413321*^9}, {
  3.721703576065333*^9, 3.7217035923916273`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gaussmasses", " ", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.721703580352276*^9, 3.72170358386998*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"10.4167`", "0", "2.60417`", "0", "5.20833`", "0", "2.60417`", "0"},
     {"0", "10.4167`", "0", "2.60417`", "0", "5.20833`", "0", "2.60417`"},
     {"2.60417`", "0", "5.20833`", "0", "2.60417`", "0", "0", "0"},
     {"0", "2.60417`", "0", "5.20833`", "0", "2.60417`", "0", "0"},
     {"5.20833`", "0", "2.60417`", "0", "10.4167`", "0", "2.60417`", "0"},
     {"0", "5.20833`", "0", "2.60417`", "0", "10.4167`", "0", "2.60417`"},
     {"2.60417`", "0", "0", "0", "2.60417`", "0", "5.20833`", "0"},
     {"0", "2.60417`", "0", "0", "0", "2.60417`", "0", "5.20833`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.721703584455636*^9, 3.7217035979285727`*^9}, 
   3.721748175049448*^9, 3.721748327536414*^9, 3.721748405867682*^9, 
   3.721748763829216*^9, 3.721749578890429*^9, 3.721749857114625*^9, 
   3.721944693765902*^9, 3.722355470010049*^9, 3.722356031002632*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mymasses", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.721703186493051*^9, 3.721703218273027*^9}, {
  3.721703635014962*^9, 3.721703636135501*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.16`", "0.`", "0.04`", "0.`", "0.08`", "0.`", "0.04`", "0.`"},
     {"0.`", "0.16`", "0.`", "0.04`", "0.`", "0.08`", "0.`", "0.04`"},
     {"0.04`", "0.`", "0.08`", "0.`", "0.04`", "0.`", "0.`", "0.`"},
     {"0.`", "0.04`", "0.`", "0.08`", "0.`", "0.04`", "0.`", "0.`"},
     {"0.08`", "0.`", "0.04`", "0.`", "0.16`", "0.`", "0.04`", "0.`"},
     {"0.`", "0.08`", "0.`", "0.04`", "0.`", "0.16`", "0.`", "0.04`"},
     {"0.04`", "0.`", "0.`", "0.`", "0.04`", "0.`", "0.08`", "0.`"},
     {"0.`", "0.04`", "0.`", "0.`", "0.`", "0.04`", "0.`", "0.08`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7217498143160763`*^9, 3.721749857136087*^9, 
  3.721944693793541*^9, 3.722355470186783*^9, 3.7223560311291733`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dForces", "[", "initpts", "]"}], ".", "initpts"}]], "Input",
 CellChangeTimes->{{3.7217440300642147`*^9, 3.72174403767841*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.3793103448275868`*^7", ",", "1.3793103448275866`*^7", ",", 
   RowBox[{"-", "1.3793103448275864`*^7"}], ",", "1.3793103448275866`*^7", 
   ",", 
   RowBox[{"-", "1.3793103448275866`*^7"}], ",", 
   RowBox[{"-", "1.3793103448275868`*^7"}], ",", "1.3793103448275866`*^7", 
   ",", 
   RowBox[{"-", "1.3793103448275864`*^7"}]}], "}"}]], "Output",
 CellChangeTimes->{3.721744038708613*^9, 3.7217481751004972`*^9, 
  3.72174832758927*^9, 3.7217484059169397`*^9, 3.7217487638817167`*^9, 
  3.7217495791342783`*^9, 3.721749825745*^9, 3.721749857164617*^9, 
  3.721944693812338*^9, 3.722355470335136*^9, 3.722356031258689*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"invMdtdtK", "=", " ", 
  RowBox[{"Inverse", "[", 
   RowBox[{"mymasses", " ", "-", " ", 
    RowBox[{"timestep", "*", "timestep", "*", 
     RowBox[{"dForces", "[", "initpts", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.685560751865531*^9, 3.685560753362475*^9}, {
  3.691297664739283*^9, 3.691297671331373*^9}, {3.721749008800062*^9, 
  3.721749059564787*^9}, {3.721749145097247*^9, 3.721749193117094*^9}, {
  3.721749706307377*^9, 3.72174970672243*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3.028949825646437`", ",", 
     RowBox[{"-", "1.4770818439624935`"}], ",", "2.4221590867012117`", ",", 
     "1.1205943821940534`", ",", 
     RowBox[{"-", "0.7815260732808311`"}], ",", "1.6120838341711423`", ",", 
     RowBox[{"-", "0.6670065914324269`"}], ",", 
     RowBox[{"-", "1.3905983626113543`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.4770818439624933`"}], ",", "3.028949825646436`", ",", 
     RowBox[{"-", "1.3905983626113543`"}], ",", 
     RowBox[{"-", "0.6670065914324268`"}], ",", "1.612083834171141`", ",", 
     RowBox[{"-", "0.7815260732808307`"}], ",", "1.1205943821940516`", ",", 
     "2.4221590867012104`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.422159086701211`", ",", 
     RowBox[{"-", "1.3905983626113538`"}], ",", "3.2750854541948513`", ",", 
     "1.8145868194841202`", ",", 
     RowBox[{"-", "0.6670065914324265`"}], ",", "1.120594382194052`", ",", 
     RowBox[{"-", "0.5353904447324219`"}], ",", 
     RowBox[{"-", "1.2745788586495201`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.1205943821940518`", ",", 
     RowBox[{"-", "0.6670065914324258`"}], ",", "1.8145868194841197`", ",", 
     "3.2750854541948495`", ",", 
     RowBox[{"-", "1.3905983626113527`"}], ",", "2.4221590867012095`", ",", 
     RowBox[{"-", "1.2745788586495188`"}], ",", 
     RowBox[{"-", "0.5353904447324209`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.7815260732808306`"}], ",", "1.6120838341711397`", ",", 
     RowBox[{"-", "0.6670065914324267`"}], ",", 
     RowBox[{"-", "1.3905983626113536`"}], ",", "3.0289498256464342`", ",", 
     RowBox[{"-", "1.4770818439624926`"}], ",", "2.4221590867012086`", ",", 
     "1.1205943821940503`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.6120838341711425`", ",", 
     RowBox[{"-", "0.7815260732808306`"}], ",", "1.1205943821940534`", ",", 
     "2.4221590867012113`", ",", 
     RowBox[{"-", "1.4770818439624929`"}], ",", "3.0289498256464364`", ",", 
     RowBox[{"-", "1.3905983626113534`"}], ",", 
     RowBox[{"-", "0.6670065914324261`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.6670065914324255`"}], ",", "1.12059438219405`", ",", 
     RowBox[{"-", "0.5353904447324213`"}], ",", 
     RowBox[{"-", "1.2745788586495193`"}], ",", "2.4221590867012086`", ",", 
     RowBox[{"-", "1.3905983626113527`"}], ",", "3.2750854541948478`", ",", 
     "1.814586819484117`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.3905983626113538`"}], ",", "2.42215908670121`", ",", 
     RowBox[{"-", "1.2745788586495204`"}], ",", 
     RowBox[{"-", "0.5353904447324221`"}], ",", "1.1205943821940514`", ",", 
     RowBox[{"-", "0.6670065914324264`"}], ",", "1.814586819484119`", ",", 
     "3.2750854541948495`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.72174918840489*^9, 3.721749193566575*^9}, 
   3.721749452269498*^9, 3.72174957925142*^9, {3.7217497001122313`*^9, 
   3.721749708119977*^9}, 3.721749766498683*^9, {3.721749828193882*^9, 
   3.7217498571861057`*^9}, 3.72194469400886*^9, 3.722355470802156*^9, 
   3.72235603137564*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"p", " ", "=", " ", "initpts"}]], "Input",
 CellChangeTimes->{{3.721749533556458*^9, 3.721749561228693*^9}, {
  3.721749629008305*^9, 3.7217496300380096`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "4", ",", "0", ",", "4", ",", "4", ",", "0", ",", "4"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.721749562446679*^9, 3.721749579362362*^9}, 
   3.72174963129672*^9, 3.7217498571922398`*^9, 3.721944694073509*^9, 
   3.722355470954548*^9, 3.722356031516687*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"p0", " ", "=", " ", 
  RowBox[{"p", "+", " ", "timestep"}]}]], "Input",
 CellChangeTimes->{{3.721943826407845*^9, 3.721943865951344*^9}, 
   3.721944637089625*^9, {3.72194467009261*^9, 3.721944700291244*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.001`", ",", "0.001`", ",", "4.001`", ",", "0.001`", ",", "4.001`", ",", 
   "4.001`", ",", "0.001`", ",", "4.001`"}], "}"}]], "Output",
 CellChangeTimes->{3.722355471074415*^9, 3.7223560316528*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"v1", " ", "=", 
  RowBox[{"invMdtdtK", ".", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"mymasses", ".", "vels"}], " ", "+", " ", 
     RowBox[{"timestep", "*", 
      RowBox[{
       RowBox[{"dForces", "[", "initpts", "]"}], ".", 
       RowBox[{"(", 
        RowBox[{"p", " ", "-", " ", "initpts"}], ")"}]}]}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"p1", " ", "=", " ", 
  RowBox[{"p", " ", "+", " ", 
   RowBox[{"timestep", "*", "v1"}]}]}]}], "Input",
 CellChangeTimes->{{3.690627638810752*^9, 3.690627639808319*^9}, {
  3.721749486759117*^9, 3.721749528678781*^9}, {3.721749566943034*^9, 
  3.721749627013999*^9}, {3.7217496882811127`*^9, 3.721749694400881*^9}, {
  3.721749843598563*^9, 3.721749928557083*^9}, {3.721749958562701*^9, 
  3.721749970940611*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.49231598605171484`", ",", 
   RowBox[{"-", "0.11816654751699973`"}], ",", "0.4437727269360968`", ",", 
   "0.08964755057552412`", ",", "0.18747791413753315`", ",", 
   "0.1289667067336914`", ",", "0.1966394726854057`", ",", 
   RowBox[{"-", "0.11124786900890855`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.721749572250498*^9, 3.721749593486768*^9}, 
   3.7217496330616503`*^9, {3.7217496949421577`*^9, 3.721749711396851*^9}, 
   3.721749769231063*^9, {3.72174983339674*^9, 3.721749864337838*^9}, {
   3.7217499114729767`*^9, 3.7217499295816917`*^9}, 3.7217499721697817`*^9, 
   3.721944694113439*^9, 3.722355471194437*^9, 3.7223560317862797`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0004923159860517149`", ",", 
   RowBox[{"-", "0.00011816654751699974`"}], ",", "4.000443772726936`", ",", 
   "0.00008964755057552413`", ",", "4.000187477914137`", ",", 
   "4.0001289667067335`", ",", "0.00019663947268540568`", ",", 
   "3.999888752130991`"}], "}"}]], "Output",
 CellChangeTimes->{{3.721749572250498*^9, 3.721749593486768*^9}, 
   3.7217496330616503`*^9, {3.7217496949421577`*^9, 3.721749711396851*^9}, 
   3.721749769231063*^9, {3.72174983339674*^9, 3.721749864337838*^9}, {
   3.7217499114729767`*^9, 3.7217499295816917`*^9}, 3.7217499721697817`*^9, 
   3.721944694113439*^9, 3.722355471194437*^9, 3.722356031787451*^9}]
}, Open  ]]
},
WindowSize->{1855, 1056},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.0 for Linux x86 (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 92, 2, 35, "Input"],
Cell[653, 24, 476, 13, 35, "Input"],
Cell[1132, 39, 377, 9, 32, "Input"],
Cell[1512, 50, 1571, 48, 74, "Input"],
Cell[CellGroupData[{
Cell[3108, 102, 963, 22, 76, "Input"],
Cell[4074, 126, 330, 6, 32, "Output"],
Cell[4407, 134, 390, 8, 32, "Output"]
}, Open  ]],
Cell[4812, 145, 1322, 25, 71, "Input"],
Cell[6137, 172, 130, 3, 32, "Input"],
Cell[6270, 177, 491, 10, 52, "Input"],
Cell[6764, 189, 1286, 38, 140, "Input"],
Cell[8053, 229, 1713, 49, 54, "Input"],
Cell[9769, 280, 198, 3, 30, "Input"],
Cell[9970, 285, 700, 17, 55, "Input"],
Cell[CellGroupData[{
Cell[10695, 306, 129, 2, 35, "Input"],
Cell[10827, 310, 380, 9, 32, "Output"]
}, Open  ]],
Cell[11222, 322, 615, 16, 35, "Input"],
Cell[11840, 340, 580, 14, 33, "Input"],
Cell[12423, 356, 101, 1, 31, "Item"],
Cell[CellGroupData[{
Cell[12549, 361, 2673, 66, 179, "Input"],
Cell[15225, 429, 289, 4, 30, "Output"]
}, Open  ]],
Cell[15529, 436, 4092, 95, 221, "Input"],
Cell[CellGroupData[{
Cell[19646, 535, 180, 3, 32, "Input"],
Cell[19829, 540, 4609, 128, 96, "Output"]
}, Open  ]],
Cell[24453, 671, 382, 11, 33, "Input"],
Cell[CellGroupData[{
Cell[24860, 686, 165, 3, 35, "Input"],
Cell[25028, 691, 1650, 38, 211, "Output"]
}, Open  ]],
Cell[26693, 732, 440, 12, 33, "Input"],
Cell[CellGroupData[{
Cell[27158, 748, 438, 8, 35, "Input"],
Cell[27599, 758, 2796, 59, 210, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30432, 822, 1752, 42, 71, "Input"],
Cell[32187, 866, 1414, 36, 52, "Output"]
}, Open  ]],
Cell[33616, 905, 1510, 38, 52, "Input"],
Cell[CellGroupData[{
Cell[35151, 947, 139, 2, 32, "Input"],
Cell[35293, 951, 1401, 27, 178, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36731, 983, 181, 3, 32, "Input"],
Cell[36915, 988, 1248, 25, 178, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38200, 1018, 162, 3, 35, "Input"],
Cell[38365, 1023, 660, 12, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39062, 1040, 487, 9, 35, "Input"],
Cell[39552, 1051, 3172, 63, 92, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42761, 1119, 182, 3, 32, "Input"],
Cell[42946, 1124, 324, 7, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43307, 1136, 232, 4, 32, "Input"],
Cell[43542, 1142, 242, 5, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43821, 1152, 802, 19, 56, "Input"],
Cell[44626, 1173, 691, 11, 32, "Output"],
Cell[45320, 1186, 681, 11, 32, "Output"]
}, Open  ]]
}
]
*)

